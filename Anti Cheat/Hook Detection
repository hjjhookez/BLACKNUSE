local Check = true
local Remote = Instance.new("RemoteEvent")
local Proxy = newproxy(true)

local OriginalENV = getfenv()
local Expected = 1

getmetatable(Proxy).__tostring = (function()
	for Level = 1, 20 do
		local StackFunc = debug.info(Level, "f")
		if not StackFunc then break end

		local Success, StackENV = pcall(getfenv, Level)
		if not Success or StackENV ~= OriginalENV then
			game.Players.LocalPlayer:Kick(string.format("레벨 %s에서 익스플로잇 환경 발견", tostring(Level)))
		else
			Expected = true
		end
	end
	return ""
end)

while Check do
	Expected = 1
	Remote:FireServer({[Proxy] = true})
	if Expected ~= true then
		game.Players.LocalPlayer:Kick("tostring 리디렉션 발견")
	end
	task.wait()
end
